[TOC]

# 精密运算放大器

## 一.运放的概述

1. 定义：    

   采用电路的方法来实现或模拟人类社会的自然现象和人类的智能活动。

2. 实现方法：硬件+软件

​       模块化设计方法：先进芯片应用 

​       EDA 设计方法：硬件设计软件化、 硬件功能软件化 

​       仿真设计方法：MULTISM、MATLAB、PROTEUS，ispPAC 

​       模拟前端设计：管级描述 

​       数字前端设计：逻辑描述

3、目标：成本低、速度快、体积小、功耗低、可靠性高 

​     能实现--------成本高

​     能模拟--------无法实时实现 

​     无法模拟

4、障碍： 电路过于复杂成本太高		  

​                  速度不够快达不实时性要求 

​      		    技术不成熟模型难以建立

5、发展趋势      

​      EDA技术的发展

​      新的功能通用器件开发

​      新的集成工艺发展

​      新材料功能器件出现

### 未来芯片发展的趋势

高速：适合实时传输信号，如视频信号要求

高精度：传感器检测微弱信号，主要是在生物科技领域的应用

高稳定度：带宽20M模拟信号，和量级为G的数字信号

智能化：将机器学习和深度学习技术集成在AI芯片上运行

### 世界主要芯片公司介绍

1.AD公司：Analog Devices, Inc,
中文名称：亚德诺半导体技术有限公司
地点：美国马萨诸塞州诺伍德市
官网：https://www.analog.com/en/index.html

2.TI公司：Texas Instruments
中文名称：德州仪器 
地点：美国得克萨斯州的达拉斯
官网：https://www.ti.com/

3.MAXIM 公司：Maxim Integrated Products
地点：美国加利福尼亚的森尼韦尔
官网：https://www.maximintegrated.com/en.html

## 二.体系结构

![image-20230219111920716](https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219111920716.png)

### 1.模拟电子技术：低频模拟小信号的放大、运算与处理

一个工程观点

两种基本思想:放大------反馈

三种分析方法：等效电路图法、瞬时极性法、虚短虚断法

四种器件：二极管、三极管、场效应管、集成运放

五种常用测试仪器：示波器、信号源、直流稳压源、交流毫伏表、万用表

六种功能电路:运算电路、有源滤波电路、电压比较器、功率放大电路、波形发生电路、直流稳压电源

### 2.数字电子技术：数字信号的逻辑运算与处理

一个数学基础：逻辑代数基础

两类逻辑电路：双极型 （TTL）、MOS型（CMOS）

三种分析与设计方法：组合逻辑电路的分析与设计，时序逻辑电路的分析与设计，数字系统的分析与设计方法

四类数字集成功能电路：SSI（门电路、触发器），MSI（编码、译码、全加、比较、寄存、计数等），LSI（RAM，ROM，PLA，PAL，GAL）和模数混合电路（单稳态触发器，多谐振荡器，555，ADC，DAC）

若干常用芯片

### 3.高频电子技术：高频模拟信号的放大与处理

高频小信号放大

高频功率放大与功率合成

选频调谐放大与高频振荡 

幅值调制/解调（AM）

频率调制/解调（FM）

相位调制/解调（PM）

无线电发射与接收

### 4.现代电子技术：高速高精度高稳定信号处理

以高速模拟电路、高速数字电路、新型有源滤波器、非线性电路为基点

以电流模技术、开关电容技术、变跨导技术、ECL技术、锁相环技术、串行A/D转化（▽-∑）技术为核心

以高速运算放大、仪用放大器、有源滤波器、模数转换器、频率合成电路为应用背景

## 三.运放的性能指标、分类和选用

### 1.运放的性能指标

直流精度：

①失调电压(Offset voltage)：运放为了在输出端获得恒定的零电压输出，而需在两个输入端所加的直流电压之差。

②温漂( temperature drift)：当环境温度变化时，失调电压、偏置电流和差电流都会发生改变。

③偏置电流(bias current)：任何一个使输出为零的具有无限大阻抗的输入电流。

④开环放大倍数：放大器输出电压的变化对加到放大器两输入端间电压变化之比。

⑤共模抑制比KCMR：放大器对差模信号的电压放大倍数Aud与对共模信号的电压放大倍数Auc之比。表征放大电路抑制共模信号及放大差模信号的能力。

交流精度

①带宽增益积(Gain–bandwidth product,简称GBWP)：放大器带宽和带宽的增益的乘积。

②压摆率(slew rate，简称SR)：输入为阶跃信号时闭环放大器的输出电压时间变化率的平均值。(V/s，V/ms和V/μs)

③转换建立时间(Settling Time)：当运输入为阶跃信号时，运放的输出响应进入并保持在规定误差带所需的时间。这个误差常见的值为0.1%, 0.05%,0.01%。

### 2.运放的分类

#### 高速放大器 

- 增益带宽：最高增益带宽放大器

AD5539:1.4GHz

OPA855:8GHz

- 压摆率：最高转化速率放大器

AD9610:3500V/µs

LMH3401:18000V/us

- 调整时间：最短调整时间放大器

AD9611:±0.1% 13ns

AD818:士0.01% 80ns

#### 精密放大器

- 失调电压：最低失调电压放大器

ADA4528-1:2.5uV

AD707:16µv

- 偏置电流：最低偏流放大器

ADA4530-1:20fA

AD549:60pA

- 温漂：最低温漂放大器

OPA4187:1nV/℃

AD707:100nv/℃

- 开环增益：最高开环增益放大器

ADHV4702-1: 170dB

AD707:13×106

- 共模抑制比：最高共模抑制比放大器

OPA2189:168dB

AD707:130dB

#### 通用型运算放大器

略

### 3.运放的选择

#### 1.失调和漂移

运算放大器的应用中，选择取决于直流失调和直流漂移特性。
问题一：电路接上信号源时，电路应该有什么样的输入电阻。
电路的输入电阻取决于源内阻𝑅_𝑆和可容许的总负载误差。
问题二：可以容许多大的漂移误差。
输入信号由两项构成，一项是VS，还有一项由VIO和IIO或IB构成，称之为漂移误差VD。
运算放大器有反相输入式和同相输入式两种接入方式。

- 反相比例运算电路

R2为平衡电阻，确保两输入端对   地直流电阻相等

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219112900015.png" alt="image-20230219112900015" style="zoom:50%;" />

虚断：
$$
i_{-} \approx i_{+} \approx 0 \Rightarrow i_1 \approx i_F
$$
虚地：
$$
\begin{aligned}
& u_{-} \approx u_{+}=0 \Rightarrow u_o=-i_F R_f \\
& A_{u f}=\frac{u_o}{u_i} \approx \frac{i_F R_f}{i_1 R_1}=-\frac{R_f}{R_1}
\end{aligned}
$$
- 特点:

1. 为深度电压并联负反馈, $\mathrm{A}_{\mathrm{uf}}=-\mathbf{R}_{\mathbf{f}} / \mathbf{R}_{\mathbf{1}}$
2. 输入电阻较小: $\mathrm{R}_{\mathrm{ir}}=\mathrm{U}_{\mathrm{i}} / \mathbf{I}_{\mathrm{i}}=-\mathrm{R}_{\mathbf{1}}$
3. $\mathbf{U}_{\mathrm{IC}}=\mathrm{U}_{+}=\mathbf{U}_{-}$, 对 $\mathbf{K}_{\mathrm{CMR}}$ （共模抑制比）要求低

   

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219113246756.png" alt="image-20230219113246756" style="zoom:50%;" />

输入电阻近似等于总电阻$R_I$
$$
\begin{aligned}
V_O & =-\frac{R_F}{R_1}\left[V_S+\left(1+\frac{R_1}{R_F}\right) V_{I O}+I_B R_1\right] \\
& =-\frac{R_F}{R_1}\left[V_S+V_D\right] \\
R_C & =0 \quad \quad R_S<<R_1 \\
V_O & =-\frac{R_F}{R_1}\left[V_S+\left(1+\frac{R_1}{R_F}\right) V_{I O}+I_{I O} R_1\right] \\
& =-\frac{R_F}{R_1}\left[V_S+V_D\right] \\
R_C & =\frac{R_F R_1}{R_F+R_1} \quad e=\frac{100 V_D}{V_S} \times 100 \%
\end{aligned}
$$

- RF大好还是RF小好？——大好

①做大一些可以减小误差
②可以增加放大倍数

- R1大好还是小好？

R1大：输入电阻与信号吸收能力成正比
R1小：可以减小误差

- 同相比例运算电路

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219113417732.png" alt="image-20230219113417732" style="zoom:50%;" />

由虚短和虚断：
$$
U_{-} \approx U_{+}=U_i
$$
由运放净输入电压为零：
$$
\begin{aligned}
& i_1 \approx i_F \\
& \left(U_o-U_i\right) / R_f=\frac{U_i}{R_1} \Rightarrow U_o=\left(1+\frac{R_f}{R_1}\right) U_i
\end{aligned}
$$
特点:
1. 为深度电压串联负反馈;
2. 闭环输入电阻大 $\mathbf{R}_{\mathrm{if}}=\infty$
3. 有较大的共模输入 $\mathrm{U}_{\mathrm{IC}}=\mathrm{U}_{\mathrm{I}}$, 要求较高的 $\mathrm{K}_{\mathrm{CMR}}$

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219113606331.png" alt="image-20230219113606331" style="zoom:67%;" />

输入电阻近似等于放大器共模电阻$R_{CM}$
$$
\begin{aligned}
V_O & =-\frac{R_1+R_2}{R_1}\left[V_S+V_{I O}+I_B R_1\right] \\
& =-\frac{R_1+R_2}{R_1} V_D \\
R_C & =0 \quad R_S \ll<R_1 \\
V_O & =-\frac{R_1+R_2}{R_1}\left[V_S+V_{I O}+I_{I O} R_1\right] \\
& =-\frac{R_1+R_2}{R_1} V_D \\
R_C & =R_S-\frac{R_1 R_2}{R_1+R_2} \quad R_1=R_{C M}
\end{aligned}
$$

|            | 输入电阻          | 漂移误差                               |
| ---------- | ----------------- | -------------------------------------- |
| 反相输入法 | 近似于R~1~        | 受R1影响，高输入电阻和低失调误差相抵触 |
| 同相输入法 | 近似于共模电阻RCM | 失调误差比反相接入法小                 |

#### 2.电流放大

电流一般是通过测量负载电压上的电压降得出。

测量电路有两种解法，被测电流注入运算放大器的反相输入端构成电流放大器，运算放大器构成电压跟随器。



<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219113942893.png" alt="image-20230219113942893" style="zoom:50%;" />
$$
\begin{aligned}
v_0 & =-R_F\left[i_S+\frac{R_F+R_S}{R_F R_S} V_{I O}+I_B\right] \\
& =-R_F\left[i_S+I_E\right] \\
R_I & =\frac{R_F R_D}{R_F+R_D}\left(\frac{1}{1+\beta A}\right)
\end{aligned}
$$
电流放大器优点：

- 电流放大器有足够的开环增益

- 连接R_F 形成闭环后输入阻抗很小

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219113953955.png" alt="image-20230219113953955" style="zoom:50%;" />
$$
\begin{aligned}
& V_O=R_F i_S+V_{I O}+I_B R_F \\
& R_S>R_F \\
& R_1 \approx R_F
\end{aligned}
$$
电压放大器缺点:
- 容易引起共模误差
- $R_F$ 要取得足够大
- 输入阻抗 $\mathrm{R}_{\mathrm{CM}}$ 随温度变化而变化

3.增益宽带

[<img src="https://s1.ax1x.com/2023/01/13/pSMpWo4.png" alt="pSMpWo4.png" style="zoom: 67%;" />](https://imgse.com/i/pSMpWo4)

反相输入方式   
$$
\frac{d v_O}{d t}=-\frac{V_S}{R_I C_S}
$$
对于反相接入接法，高输入电阻和快响应不易兼得

[<img src="https://s1.ax1x.com/2023/01/13/pSMp5WR.png" alt="pSMp5WR.png" style="zoom:67%;" />](https://imgse.com/i/pSMp5WR)

同相输入方式

输入电阻和R1、R2无关，因而R2的值可以选得很小，杂散电容的值不会限制电路的带宽。

##### 4.应用

1.稳态应用：放大或者处理连续的正弦波形参的复杂波形。需要考虑两个方面：反馈、带宽。

2.瞬态应用：模数转化器、数模转换器和脉冲放大器，宽带放大器的瞬态响应甚至比增益带宽特性更重要，其转换速率、过载恢复时间和调整时间决定了瞬态响应。

### 精密放大器的应用及选择

电流检测和控制应用
根据具体要求的不同，检测电流强度的方法很多。其中包括使用电阻器的分路传感器、霍尔效应传感器以及电流互感器。
分路传感器技术是将一个电阻器置于被测量电源的线路中。因为电阻压降会影响功效，所以通常需要使用尽可能小的电阻值。而这就意味在电流检测应用中，必须放大相对较小的电阻差分功率。
因此，运算放大器电路必须提供高共模范围和高精度。低功耗也是一个重要要求，特别是对电池应用的传感器。嵌入式电流检测电路也需要相对便宜，以便不显著增加被监测产品的物料成本。

## 四、新技术：数字修调技术

### 输入失调的基本概念：从基本差分放大电路开始

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219114244189.png" alt="image-20230219114244189" style="zoom: 33%;" />

这是模拟电子技术运算放大器章节的差分放大电路，也叫差分放大级，用于抑制共模输入，放大差模输入。
但是，由于放大器差分输入级的电阻对 (或电流)不平衡，会造成两端输入造成微小的差别，这就叫输入失调。
要解决输入失调，可以调整其中一边的电阻(或电流)使其两端输入尽量保持一致，就可以减小失调电压，这就是失调误差修整技术。

### 数字修调的原理分析

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219114353724.png" alt="image-20230219114353724" style="zoom:50%;" />

数字修调工作原理可以如下概括：
$$
\begin{aligned}
& V_{o s P}=V_{o s(M P 1 / M P 2)}+V_{o s(\mathrm{etc})} \\
& V_{o s N}=V_{o s(M N 1 / M N 2)}+V_{o s(\mathrm{etc})}
\end{aligned}
$$
这就是P管和N管带来的失调电压大小

接着，我们需要计算出补偿失调电压所带来的补偿电流
$$
\begin{aligned}
& I_{\operatorname{trim} P}=V_{o s P} * G_{m(M P 1 / M P 2)} \\
& I_{\operatorname{trim} N}=V_{o s N} * G_{m(M N 1 / M N 2)}
\end{aligned}
$$
最后给两个输入级加上补偿电流即可

### 数字修调的第一步:信号转换与发生

信号产生模块实质是一个类A/D模块。

运放的两个端口分别提供时钟信号和有效数据信号，这个电路将输入的模拟信号转换为一个比较干净的21位数字信号。

其中第1到第8位为固定信号，第9到第21位数字信号给下一个模块的操作提供了数据支撑

[<img src="https://s1.ax1x.com/2023/01/13/pSM996P.png" alt="pSM996P.png" style="zoom:50%;" />](https://imgse.com/i/pSM996P)

##### 3.数字修调的核心：熔丝模块

前面提到的第9到第21位数字信号，被传输到这里，作为熔断熔丝的控制信号这个模块的机理和可编程逻辑阵列（PAL）有一些相似，通过熔断熔丝来控制逻辑输出。熔丝电路的内部结构图如图3所示其中A=1，B=0。熔丝电阻未熔断时输出Y始终为，熔丝熔断后，Y的值保持为1。通过分析可知，当D端口输入为1，同时E端口的输入也为1时，熔丝电阻熔断。此时无论C=1/0，熔丝电路输出Y为1显然这种熔断机制是一次性编辑，操作是不可逆的。

[<img src="https://s1.ax1x.com/2023/01/13/pSM9F0S.png" alt="pSM9F0S.png" style="zoom:67%;" />](https://imgse.com/i/pSM9F0S)

### 数字修调的输出：开关电路模板

<img src="https://mypic-1312707183.cos.ap-nanjing.myqcloud.com/image-20230219114513022.png" alt="image-20230219114513022" style="zoom:67%;" />

开关电路模块则是通过不同的开关开启与否来输出。

Ma1，Ma2，···Man是一组电流源晶体管， 由Ma0偏置，偏置电流大小由电流源I1控制；

Mc1， Mc2，···Mcn为另一组电流源晶体管，由Mc0偏置，由NMOS差分对的电流控制；

Mb1，Mb2，···Mbn；Md1， Md2，···Mdn为两组开关晶体管，由上一级电路中熔丝电路的输出Y信号通过逻辑门转换得到控制信号

通过控制这些电路的开与关来控制Me1，Me2，Me3，Me4晶体管上流过的电流的大小。Me1，Me2， Me3，Me4晶体管也由上一级数字电路输出决定，这四个晶体管的开关用于决定修调输出由P补偿端口还是由N补偿端口产生补偿电流信号

### 四.最新芯片展示

##### 1.三大深度学习芯片

1.谷歌的Tensor处理单元(TPU)：TPU是针对TensorFlow（谷歌的开源计算框架）上的机器学习工作负载量身定制的定制应用专用集成电路（ASIC）。 Cloud TPU适用于推理和机器学习培训。 Cloud TPU采用四个定制ASIC构建，可提供强大的64 GB高带宽内存和180 TFLOPS（每秒浮点运算次数）性能。 AlphaGo使用了48个TPU进行推理。

2.英特尔的Lake Crest：新芯片将采用从MCM（多芯片模块）设计到“Flexpoint”(一种有效的深度神经网络训练的自适应数值格式)架构的一系列先进功能，具有十几个专用的多核处理节点，如TPU的矩阵乘法单元。这些芯片将具有32 GB的高带宽内存2（HBM2，最大带宽可达307 GB，一般用于显卡），通过内插器连接的总带宽为8TB / s。

3.Knupath的Hermosa：64个DMA引擎和256个DSP内核，由八个内核组成，由八个内核连接，由Lambda Fabric连接。 Lambda Fabric还设计用于在低延迟和高吞吐量网格中连接数千个Hermosa处理器。Knupath的Hermosa许多核心处理器拥有256个DSP内核，由八个内核组成。用稀疏矩阵来促进深度学习训练在性能、效率和编程上获得优势的可能性。

##### 2.苹果基于ARM架构的自研M1芯片

苹果终于发布了第一款自主研发的Mac平台处理器，定名为“M1”。该芯片最新的台积电5nm工艺制造，集成多达160亿个晶体管，而且是一颗完整的SoC(System on Chip，片上系统)，集成所有相关模块，并采用苹果自创的封装方式。CISC特点是专事专办，每个复杂任务都有特定的指令完成，比如有一些指令是“消防员”，他们去灭火很专业，但缺点是如果交通堵塞，消防员就无能为力，必须得派交警过去。RISC只有简单指令，就好比城市里没有消防员也没有交警，只有广大平民百姓。当要解决简单任务时，每个人都可以上阵干活，速度更快。